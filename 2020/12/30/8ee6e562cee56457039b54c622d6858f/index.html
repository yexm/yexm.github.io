<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>golang服务内存信息 | yexm</title><meta name="author" content="yexm"><meta name="copyright" content="yexm"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="runtime中和内存使用情况相关的结构体为runtime.MemStats，这个结构定义了golang运行过程中所有内存相关的信息，在源代码中定义如下： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656">
<meta property="og:type" content="article">
<meta property="og:title" content="golang服务内存信息">
<meta property="og:url" content="https://yexm.github.io/2020/12/30/8ee6e562cee56457039b54c622d6858f/index.html">
<meta property="og:site_name" content="yexm">
<meta property="og:description" content="runtime中和内存使用情况相关的结构体为runtime.MemStats，这个结构定义了golang运行过程中所有内存相关的信息，在源代码中定义如下： 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yexm.github.io/2020/12/30/8ee6e562cee56457039b54c622d6858f/go-code.png">
<meta property="article:published_time" content="2020-12-30T14:33:57.000Z">
<meta property="article:modified_time" content="2021-05-16T11:08:54.505Z">
<meta property="article:author" content="yexm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yexm.github.io/2020/12/30/8ee6e562cee56457039b54c622d6858f/go-code.png"><link rel="shortcut icon" href="/img/avatar.png"><link rel="canonical" href="https://yexm.github.io/2020/12/30/8ee6e562cee56457039b54c622d6858f/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":10,"languages":{"author":"作者: yexm","link":"链接: ","source":"来源: yexm","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'golang服务内存信息',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-05-16 19:08:54'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">93</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">yexm</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">golang服务内存信息</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2021-05-16T11:08:54.505Z" title="undefined 2021-05-16 19:08:54">2021-05-16</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>19分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="golang服务内存信息"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div><article class="post-content" id="article-container"><p>runtime中和内存使用情况相关的结构体为runtime.MemStats，这个结构定义了golang运行过程中所有内存相关的信息，在源代码中定义如下：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br></pre></td><td class="code"><pre><span class="line">// A MemStats records statistics about the memory allocator. 记录内存分配器的信息</span><br><span class="line">type MemStats struct {</span><br><span class="line">    // General statistics.</span><br><span class="line"></span><br><span class="line">    // Alloc is bytes of allocated heap objects.</span><br><span class="line">    // 堆空间分配的字节数</span><br><span class="line">    // This is the same as HeapAlloc (see below).</span><br><span class="line">    Alloc uint64</span><br><span class="line"></span><br><span class="line">    // TotalAlloc is cumulative bytes allocated for heap objects.</span><br><span class="line">    //</span><br><span class="line">    // TotalAlloc increases as heap objects are allocated, but</span><br><span class="line">    // unlike Alloc and HeapAlloc, it does not decrease when</span><br><span class="line">    // objects are freed. 从服务开始运行至今分配器为分配的堆空间总和</span><br><span class="line">    TotalAlloc uint64</span><br><span class="line"></span><br><span class="line">    // Sys is the total bytes of memory obtained from the OS.</span><br><span class="line">    //</span><br><span class="line">    // Sys is the sum of the XSys fields below. Sys measures the</span><br><span class="line">    // virtual address space reserved by the Go runtime for the</span><br><span class="line">    // heap, stacks, and other internal data structures. It's</span><br><span class="line">    // likely that not all of the virtual address space is backed</span><br><span class="line">    // by physical memory at any given moment, though in general</span><br><span class="line">    // it all was at some point. 服务现在使用的内存</span><br><span class="line">    Sys uint64</span><br><span class="line"></span><br><span class="line">    // Lookups is the number of pointer lookups performed by the</span><br><span class="line">    // runtime.</span><br><span class="line">    //</span><br><span class="line">    // This is primarily useful for debugging runtime internals. 被runtime监视的指针数</span><br><span class="line">    Lookups uint64</span><br><span class="line"></span><br><span class="line">    // Mallocs is the cumulative count of heap objects allocated. 服务malloc的次数</span><br><span class="line">    // The number of live objects is Mallocs - Frees.</span><br><span class="line">    Mallocs uint64</span><br><span class="line"></span><br><span class="line">    // Frees is the cumulative count of heap objects freed. 服务回收的heap objects</span><br><span class="line">    Frees uint64</span><br><span class="line"></span><br><span class="line">    // Heap memory statistics.</span><br><span class="line">    //</span><br><span class="line">    // Interpreting the heap statistics requires some knowledge of</span><br><span class="line">    // how Go organizes memory. Go divides the virtual address</span><br><span class="line">    // space of the heap into "spans", which are contiguous</span><br><span class="line">    // regions of memory 8K or larger. A span may be in one of</span><br><span class="line">    // three states:</span><br><span class="line">    //</span><br><span class="line">    // An "idle" span contains no objects or other data. The</span><br><span class="line">    // physical memory backing an idle span can be released back</span><br><span class="line">    // to the OS (but the virtual address space never is), or it</span><br><span class="line">    // can be converted into an "in use" or "stack" span.</span><br><span class="line">    //</span><br><span class="line">    // An "in use" span contains at least one heap object and may</span><br><span class="line">    // have free space available to allocate more heap objects.</span><br><span class="line">    //</span><br><span class="line">    // A "stack" span is used for goroutine stacks. Stack spans</span><br><span class="line">    // are not considered part of the heap. A span can change</span><br><span class="line">    // between heap and stack memory; it is never used for both</span><br><span class="line">    // simultaneously.</span><br><span class="line"></span><br><span class="line">    // HeapAlloc is bytes of allocated heap objects.</span><br><span class="line">    //</span><br><span class="line">    // "Allocated" heap objects include all reachable objects, as</span><br><span class="line">    // well as unreachable objects that the garbage collector has</span><br><span class="line">    // not yet freed. Specifically, HeapAlloc increases as heap</span><br><span class="line">    // objects are allocated and decreases as the heap is swept</span><br><span class="line">    // and unreachable objects are freed. Sweeping occurs</span><br><span class="line">    // incrementally between GC cycles, so these two processes</span><br><span class="line">    // occur simultaneously, and as a result HeapAlloc tends to</span><br><span class="line">    // change smoothly (in contrast with the sawtooth that is</span><br><span class="line">    // typical of stop-the-world garbage collectors).</span><br><span class="line">    //服务分配的堆内存</span><br><span class="line">    HeapAlloc uint64</span><br><span class="line"></span><br><span class="line">    // HeapSys is bytes of heap memory obtained from the OS.</span><br><span class="line">    //</span><br><span class="line">    // HeapSys measures the amount of virtual address space</span><br><span class="line">    // reserved for the heap. This includes virtual address space</span><br><span class="line">    // that has been reserved but not yet used, which consumes no</span><br><span class="line">    // physical memory, but tends to be small, as well as virtual</span><br><span class="line">    // address space for which the physical memory has been</span><br><span class="line">    // returned to the OS after it became unused (see HeapReleased</span><br><span class="line">    // for a measure of the latter).</span><br><span class="line">    //</span><br><span class="line">    // HeapSys estimates the largest size the heap has had.</span><br><span class="line">    //系统分配的堆内存</span><br><span class="line">    HeapSys uint64</span><br><span class="line"></span><br><span class="line">    // HeapIdle is bytes in idle (unused) spans.</span><br><span class="line">    //</span><br><span class="line">    // Idle spans have no objects in them. These spans could be</span><br><span class="line">    // (and may already have been) returned to the OS, or they can</span><br><span class="line">    // be reused for heap allocations, or they can be reused as</span><br><span class="line">    // stack memory.</span><br><span class="line">    //</span><br><span class="line">    // HeapIdle minus HeapReleased estimates the amount of memory</span><br><span class="line">    // that could be returned to the OS, but is being retained by</span><br><span class="line">    // the runtime so it can grow the heap without requesting more</span><br><span class="line">    // memory from the OS. If this difference is significantly</span><br><span class="line">    // larger than the heap size, it indicates there was a recent</span><br><span class="line">    // transient spike in live heap size.</span><br><span class="line">    //申请但是为分配的堆内存，（或者回收了的堆内存）</span><br><span class="line">    HeapIdle uint64</span><br><span class="line"></span><br><span class="line">    // HeapInuse is bytes in in-use spans.</span><br><span class="line">    //</span><br><span class="line">    // In-use spans have at least one object in them. These spans</span><br><span class="line">    // can only be used for other objects of roughly the same</span><br><span class="line">    // size.</span><br><span class="line">    //</span><br><span class="line">    // HeapInuse minus HeapAlloc esimates the amount of memory</span><br><span class="line">    // that has been dedicated to particular size classes, but is</span><br><span class="line">    // not currently being used. This is an upper bound on</span><br><span class="line">    // fragmentation, but in general this memory can be reused</span><br><span class="line">    // efficiently.</span><br><span class="line">    //正在使用的堆内存</span><br><span class="line">    HeapInuse uint64</span><br><span class="line"></span><br><span class="line">    // HeapReleased is bytes of physical memory returned to the OS.</span><br><span class="line">    //</span><br><span class="line">    // This counts heap memory from idle spans that was returned</span><br><span class="line">    // to the OS and has not yet been reacquired for the heap.</span><br><span class="line">    //返回给OS的堆内存，类似C/C++中的free。</span><br><span class="line">    HeapReleased uint64</span><br><span class="line"></span><br><span class="line">    // HeapObjects is the number of allocated heap objects.</span><br><span class="line">    //</span><br><span class="line">    // Like HeapAlloc, this increases as objects are allocated and</span><br><span class="line">    // decreases as the heap is swept and unreachable objects are</span><br><span class="line">    // freed.</span><br><span class="line">    //堆内存块申请的量</span><br><span class="line">    HeapObjects uint64</span><br><span class="line"></span><br><span class="line">    // Stack memory statistics.</span><br><span class="line">    //</span><br><span class="line">    // Stacks are not considered part of the heap, but the runtime</span><br><span class="line">    // can reuse a span of heap memory for stack memory, and</span><br><span class="line">    // vice-versa.</span><br><span class="line"></span><br><span class="line">    // StackInuse is bytes in stack spans.</span><br><span class="line">    //</span><br><span class="line">    // In-use stack spans have at least one stack in them. These</span><br><span class="line">    // spans can only be used for other stacks of the same size.</span><br><span class="line">    //</span><br><span class="line">    // There is no StackIdle because unused stack spans are</span><br><span class="line">    // returned to the heap (and hence counted toward HeapIdle).</span><br><span class="line">    //正在使用的栈</span><br><span class="line">    StackInuse uint64</span><br><span class="line"></span><br><span class="line">    // StackSys is bytes of stack memory obtained from the OS.</span><br><span class="line">    //</span><br><span class="line">    // StackSys is StackInuse, plus any memory obtained directly</span><br><span class="line">    // from the OS for OS thread stacks (which should be minimal).</span><br><span class="line">    //系统分配的作为运行栈的内存</span><br><span class="line">    StackSys uint64</span><br><span class="line"></span><br><span class="line">    // Off-heap memory statistics.</span><br><span class="line">    //</span><br><span class="line">    // The following statistics measure runtime-internal</span><br><span class="line">    // structures that are not allocated from heap memory (usually</span><br><span class="line">    // because they are part of implementing the heap). Unlike</span><br><span class="line">    // heap or stack memory, any memory allocated to these</span><br><span class="line">    // structures is dedicated to these structures.</span><br><span class="line">    //</span><br><span class="line">    // These are primarily useful for debugging runtime memory</span><br><span class="line">    // overheads.</span><br><span class="line"></span><br><span class="line">    // MSpanInuse is bytes of allocated mspan structures. 用于测试用的结构体使用的字节数</span><br><span class="line">    MSpanInuse uint64</span><br><span class="line"></span><br><span class="line">    // MSpanSys is bytes of memory obtained from the OS for mspan</span><br><span class="line">    // structures. 系统为测试用的结构体分配的字节数</span><br><span class="line">    MSpanSys uint64</span><br><span class="line"></span><br><span class="line">    // MCacheInuse is bytes of allocated mcache structures. mcache结构体申请的字节数</span><br><span class="line">    MCacheInuse uint64</span><br><span class="line"></span><br><span class="line">    // MCacheSys is bytes of memory obtained from the OS for</span><br><span class="line">    // mcache structures. 操作系统申请的堆空间用于mcache的量</span><br><span class="line">    MCacheSys uint64</span><br><span class="line"></span><br><span class="line">    // BuckHashSys is bytes of memory in profiling bucket hash tables.用于剖析桶散列表的堆空间</span><br><span class="line">    BuckHashSys uint64</span><br><span class="line"></span><br><span class="line">    // GCSys is bytes of memory in garbage collection metadata. 垃圾回收标记元信息使用的内存</span><br><span class="line">    GCSys uint64</span><br><span class="line"></span><br><span class="line">    // OtherSys is bytes of memory in miscellaneous off-heap</span><br><span class="line">    // runtime allocations.  golang系统架构占用的额外空间</span><br><span class="line">    OtherSys uint64</span><br><span class="line"></span><br><span class="line">    // Garbage collector statistics.</span><br><span class="line"></span><br><span class="line">    // NextGC is the target heap size of the next GC cycle.</span><br><span class="line">    //</span><br><span class="line">    // The garbage collector's goal is to keep HeapAlloc ≤ NextGC.</span><br><span class="line">    // At the end of each GC cycle, the target for the next cycle</span><br><span class="line">    // is computed based on the amount of reachable data and the</span><br><span class="line">    // value of GOGC. 垃圾回收器检视的内存大小</span><br><span class="line">    NextGC uint64</span><br><span class="line"></span><br><span class="line">    // LastGC is the time the last garbage collection finished, as</span><br><span class="line">    // nanoseconds since 1970 (the UNIX epoch).</span><br><span class="line">    // 垃圾回收器最后一次执行时间。</span><br><span class="line">    LastGC uint64</span><br><span class="line"></span><br><span class="line">    // PauseTotalNs is the cumulative nanoseconds in GC</span><br><span class="line">    // stop-the-world pauses since the program started.</span><br><span class="line">    //</span><br><span class="line">    // During a stop-the-world pause, all goroutines are paused</span><br><span class="line">    // and only the garbage collector can run. </span><br><span class="line">    // 垃圾回收或者其他信息收集导致服务暂停的次数。</span><br><span class="line">    PauseTotalNs uint64</span><br><span class="line"></span><br><span class="line">    // PauseNs is a circular buffer of recent GC stop-the-world</span><br><span class="line">    // pause times in nanoseconds.</span><br><span class="line">    //</span><br><span class="line">    // The most recent pause is at PauseNs[(NumGC+255)%256]. In</span><br><span class="line">    // general, PauseNs[N%256] records the time paused in the most</span><br><span class="line">    // recent N%256th GC cycle. There may be multiple pauses per</span><br><span class="line">    // GC cycle; this is the sum of all pauses during a cycle. 一个循环队列，记录最近垃圾回收系统中断的时间</span><br><span class="line">    PauseNs [256]uint64</span><br><span class="line"></span><br><span class="line">    // PauseEnd is a circular buffer of recent GC pause end times,</span><br><span class="line">    // as nanoseconds since 1970 (the UNIX epoch).</span><br><span class="line">    //</span><br><span class="line">    // This buffer is filled the same way as PauseNs. There may be</span><br><span class="line">    // multiple pauses per GC cycle; this records the end of the</span><br><span class="line">    // last pause in a cycle. 一个循环队列，记录最近垃圾回收系统中断的时间开始点。</span><br><span class="line">    PauseEnd [256]uint64</span><br><span class="line"></span><br><span class="line">    // NumGC is the number of completed GC cycles.</span><br><span class="line">    //垃圾回收的内存大小</span><br><span class="line">    NumGC uint32</span><br><span class="line"></span><br><span class="line">    // NumForcedGC is the number of GC cycles that were forced by</span><br><span class="line">    // the application calling the GC function.</span><br><span class="line">    //服务调用runtime.GC()强制使用垃圾回收的次数。</span><br><span class="line">    NumForcedGC uint32</span><br><span class="line"></span><br><span class="line">    // GCCPUFraction is the fraction of this program's available</span><br><span class="line">    // CPU time used by the GC since the program started.</span><br><span class="line">    //</span><br><span class="line">    // GCCPUFraction is expressed as a number between 0 and 1,</span><br><span class="line">    // where 0 means GC has consumed none of this program's CPU. A</span><br><span class="line">    // program's available CPU time is defined as the integral of</span><br><span class="line">    // GOMAXPROCS since the program started. That is, if</span><br><span class="line">    // GOMAXPROCS is 2 and a program has been running for 10</span><br><span class="line">    // seconds, its "available CPU" is 20 seconds. GCCPUFraction</span><br><span class="line">    // does not include CPU time used for write barrier activity.</span><br><span class="line">    //</span><br><span class="line">    // This is the same as the fraction of CPU reported by</span><br><span class="line">    // GODEBUG=gctrace=1.</span><br><span class="line">    //垃圾回收占用服务CPU工作的时间总和。如果有100个goroutine，垃圾回收的时间为1S,那么久占用了100S</span><br><span class="line">    GCCPUFraction float64</span><br><span class="line"></span><br><span class="line">    // EnableGC indicates that GC is enabled. It is always true,</span><br><span class="line">    // even if GOGC=off.</span><br><span class="line">    //是否启用GC</span><br><span class="line">    EnableGC bool</span><br><span class="line"></span><br><span class="line">    // DebugGC is currently unused.</span><br><span class="line">    DebugGC bool</span><br><span class="line"></span><br><span class="line">    // BySize reports per-size class allocation statistics.</span><br><span class="line">    //</span><br><span class="line">    // BySize[N] gives statistics for allocations of size S where</span><br><span class="line">    // BySize[N-1].Size &lt; S ≤ BySize[N].Size.</span><br><span class="line">    //</span><br><span class="line">    // This does not report allocations larger than BySize[60].Size.</span><br><span class="line">    //内存分配器使用情况</span><br><span class="line">    BySize [61]struct {</span><br><span class="line">        // Size is the maximum byte size of an object in this</span><br><span class="line">        // size class.</span><br><span class="line">        Size uint32</span><br><span class="line"></span><br><span class="line">        // Mallocs is the cumulative count of heap objects</span><br><span class="line">        // allocated in this size class. The cumulative bytes</span><br><span class="line">        // of allocation is Size*Mallocs. The number of live</span><br><span class="line">        // objects in this size class is Mallocs - Frees.</span><br><span class="line">        Mallocs uint64</span><br><span class="line"></span><br><span class="line">        // Frees is the cumulative count of heap objects freed</span><br><span class="line">        // in this size class.</span><br><span class="line">        Frees uint64</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>runtime.MemStats这个结构体包含的字段比较多，但是大多都很有用，去掉那些注释来看各个属性，会发现各个属性都是很有价值的：<br>1、Alloc uint64 //golang语言框架堆空间分配的字节数<br>2、TotalAlloc uint64 //从服务开始运行至今分配器为分配的堆空间总 和，只有增加，释放的时候不减少<br>3、Sys uint64 //服务现在系统使用的内存<br>4、Lookups uint64 //被runtime监视的指针数<br>5、Mallocs uint64 //服务malloc的次数<br>6、Frees uint64 //服务回收的heap objects的字节数<br>7、HeapAlloc uint64 //服务分配的堆内存字节数<br>8、HeapSys uint64 //系统分配的作为运行栈的内存<br>9、HeapIdle uint64 //申请但是未分配的堆内存或者回收了的堆内存（空闲）字节数<br>10、HeapInuse uint64 //正在使用的堆内存字节数<br>10、HeapReleased uint64 //返回给OS的堆内存，类似C/C++中的free。<br>11、HeapObjects uint64 //堆内存块申请的量<br>12、StackInuse uint64 //正在使用的栈字节数<br>13、StackSys uint64 //系统分配的作为运行栈的内存<br>14、MSpanInuse uint64 //用于测试用的结构体使用的字节数<br>15、MSpanSys uint64 //系统为测试用的结构体分配的字节数<br>16、MCacheInuse uint64 //mcache结构体申请的字节数(不会被视为垃圾回收)<br>17、MCacheSys uint64 //操作系统申请的堆空间用于mcache的字节数<br>18、BuckHashSys uint64 //用于剖析桶散列表的堆空间<br>19、GCSys uint64 //垃圾回收标记元信息使用的内存<br>20、OtherSys uint64 //golang系统架构占用的额外空间<br>21、NextGC uint64 //垃圾回收器检视的内存大小<br>22、LastGC uint64 // 垃圾回收器最后一次执行时间。<br>23、PauseTotalNs uint64 // 垃圾回收或者其他信息收集导致服务暂停的次数。<br>24、PauseNs [256]uint64 //一个循环队列，记录最近垃圾回收系统中断的时间<br>25、PauseEnd [256]uint64 //一个循环队列，记录最近垃圾回收系统中断的时间开始点。<br>26、NumForcedGC uint32 //服务调用runtime.GC()强制使用垃圾回收的次数。<br>27、GCCPUFraction float64 //垃圾回收占用服务CPU工作的时间总和。如果有100个goroutine，垃圾回收的时间为1S,那么久占用了100S。<br>28、BySize //内存分配器使用情况 </p>
<p>从runtime.MemStats的属性可以看到，golang中的runtime包其实是一个带有一点维护性质的功能包。开发者可以获取大量golang服务运行时的信息，查看runtime.MenStats的方法也很简单。直接调用runtime.ReadMemStats方法即可获取调用点服务运行信息。一下是我测试过程中获取到的runtime.MenStats，内容如下：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">memstat: {</span><br><span class="line">Alloc:69257680 //golang语言框架堆空间分配的字节数 大概68M</span><br><span class="line">TotalAlloc:79489528 //从服务开始运行至今分配器为分配的堆空间总 和，只有增加，释放的时候不减少。大约79M</span><br><span class="line">Sys:1345724664 //服务现在系统使用的内存, 大约1345M</span><br><span class="line">Lookups:3 //被runtime监视的指针数</span><br><span class="line">Mallocs:307494 //服务malloc的次数</span><br><span class="line">Frees:9105  //服务回收的heap objects的字节数 free次数</span><br><span class="line">HeapAlloc:69257680 //golang语言框架堆空间分配的字节数 大概68M</span><br><span class="line">HeapSys:71434240  //系统分配的堆内存 大概71M</span><br><span class="line">HeapIdle:974848 //申请但是未分配的堆内存或者回收了的堆内存（空闲）字节数 大概1M</span><br><span class="line">HeapInuse:70459392 //正在使用的堆内存字节数 大概70M</span><br><span class="line">HeapReleased:0 //返回给OS的堆内存，</span><br><span class="line">HeapObjects:298389  //堆内存块申请的量</span><br><span class="line">StackInuse:1220804608 //正在使用的栈字节数 约1220M</span><br><span class="line">StackSys:1220804608 //系统分配的作为运行栈的内存 约1220M</span><br><span class="line">MSpanInuse:6924360  //用于测试用的结构体使用的字节数 不受GC控制， 约7M</span><br><span class="line">MSpanSys:6979584 //系统为测试用的结构体分配的字节数 约7M</span><br><span class="line">MCacheInuse:6816 //mcache结构体申请的字节数(不会被视为垃圾回收) 约6K</span><br><span class="line">MCacheSys:16384 //操作系统申请的堆空间用于mcache的字节数,约16K</span><br><span class="line">BuckHashSys:1468496 //用于剖析桶散列表的堆空间 约14K</span><br><span class="line">GCSys:40984576 //垃圾回收标记元信息使用的内存 约40M</span><br><span class="line">OtherSys:4036776 //golang系统架构占用的额外空间 约4M</span><br><span class="line">NextGC:135394784  //垃圾回收器检视的内存大小 约135M</span><br><span class="line">LastGC:1506577064496115700 //最后一次GC的时间戳</span><br><span class="line">PauseTotalNs:1834800 //系统暂停的时间，大约1.8毫秒</span><br><span class="line">PauseNs:[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 833700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 131600 0 69500 299900 500100 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] //最近垃圾回收消耗情况</span><br><span class="line">PauseEnd:[1506576868237062600 1506576873250702600 1506576878266318900 1506576883290562700 1506576888313706000 1506576893339216000 1506576898380539200 1506576903430807600 1506576908483751100 1506576913540053700 1506576918589605600 1506576923651466900 1506576928716329900 1506576933785270400 1506576938872682700 1506576943987556700 1506576949080171300 1506576954205844600 1506576959319027700 1506576964454667000 1506576969604832300 1506576974795338100 1506576979945880300 1506576985117374500 1506576990330379400 1506576995548568900 1506577000766977100 1506577005980367800 1506577011190038400 1506577016427160200 1506577021671897800 1506577026958806600 1506577032285905300 1506577037561334600 1506577042926588300 1506577048190473200 1506577053579177600 1506577059147393600 1506577064496115700 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0] //垃圾回收调用的时间点</span><br><span class="line">NumGC:39 //垃圾回收调用次数</span><br><span class="line">NumForcedGC:39 </span><br><span class="line">GCCPUFraction:-1.325626798158314e-06 //调用GC消耗的性能</span><br><span class="line">EnableGC:true </span><br><span class="line">DebugGC:false </span><br><span class="line">BySize:[</span><br><span class="line">{Size:0 Mallocs:0 Frees:0} </span><br><span class="line">{Size:8 Mallocs:45 Frees:41} </span><br><span class="line">{Size:16 Mallocs:4316 Frees:4273} </span><br><span class="line">{Size:32 Mallocs:118 Frees:58} </span><br><span class="line">{Size:48 Mallocs:192 Frees:1} </span><br><span class="line">{Size:64 Mallocs:149078 Frees:52} </span><br><span class="line">{Size:80 Mallocs:6 Frees:1} </span><br><span class="line">{Size:96 Mallocs:4 Frees:0} </span><br><span class="line">{Size:112 Mallocs:1 Frees:1} </span><br><span class="line">{Size:128 Mallocs:41 Frees:41} </span><br><span class="line">{Size:144 Mallocs:0 Frees:0} </span><br><span class="line">{Size:160 Mallocs:1 Frees:1} </span><br><span class="line">{Size:176 Mallocs:0 Frees:0} </span><br><span class="line">{Size:192 Mallocs:50 Frees:50} </span><br><span class="line">{Size:208 Mallocs:2 Frees:0} </span><br><span class="line">{Size:224 Mallocs:0 Frees:0} </span><br><span class="line">{Size:240 Mallocs:0 Frees:0} </span><br><span class="line">{Size:256 Mallocs:48 Frees:41} </span><br><span class="line">{Size:288 Mallocs:0 Frees:0} </span><br><span class="line">{Size:320 Mallocs:1 Frees:0} </span><br><span class="line">{Size:352 Mallocs:0 Frees:0} </span><br><span class="line">{Size:384 Mallocs:149024 Frees:0} </span><br><span class="line">{Size:416 Mallocs:1 Frees:0} </span><br><span class="line">{Size:448 Mallocs:0 Frees:0} </span><br><span class="line">{Size:480 Mallocs:3 Frees:0} </span><br><span class="line">{Size:512 Mallocs:80 Frees:80} </span><br><span class="line">{Size:576 Mallocs:0 Frees:0} </span><br><span class="line">{Size:640 Mallocs:0 Frees:0} </span><br><span class="line">{Size:704 Mallocs:0 Frees:0} </span><br><span class="line">{Size:768 Mallocs:0 Frees:0} </span><br><span class="line">{Size:896 Mallocs:7 Frees:0} </span><br><span class="line">{Size:1024 Mallocs:41 Frees:41} </span><br><span class="line">{Size:1152 Mallocs:1 Frees:0} </span><br><span class="line">{Size:1280 Mallocs:8 Frees:8} </span><br><span class="line">{Size:1408 Mallocs:0 Frees:0} </span><br><span class="line">{Size:1536 Mallocs:0 Frees:0} </span><br><span class="line">{Size:1792 Mallocs:10 Frees:8} </span><br><span class="line">{Size:2048 Mallocs:33 Frees:33} </span><br><span class="line">{Size:2304 Mallocs:8 Frees:8} </span><br><span class="line">{Size:2688 Mallocs:31 Frees:31} </span><br><span class="line">{Size:3072 Mallocs:8 Frees:8} </span><br><span class="line">{Size:3200 Mallocs:0 Frees:0} </span><br><span class="line">{Size:3456 Mallocs:31 Frees:31} </span><br><span class="line">{Size:4096 Mallocs:10 Frees:10} </span><br><span class="line">{Size:4864 Mallocs:35 Frees:31} </span><br><span class="line">{Size:5376 Mallocs:0 Frees:0} </span><br><span class="line">{Size:6144 Mallocs:39 Frees:39} </span><br><span class="line">{Size:6528 Mallocs:0 Frees:0} </span><br><span class="line">{Size:6784 Mallocs:0 Frees:0} </span><br><span class="line">{Size:6912 Mallocs:0 Frees:0} </span><br><span class="line">{Size:8192 Mallocs:3 Frees:2} </span><br><span class="line">{Size:9472 Mallocs:0 Frees:0} </span><br><span class="line">{Size:9728 Mallocs:0 Frees:0} </span><br><span class="line">{Size:10240 Mallocs:2 Frees:2} </span><br><span class="line">{Size:10880 Mallocs:0 Frees:0} </span><br><span class="line">{Size:12288 Mallocs:0 Frees:0} </span><br><span class="line">{Size:13568 Mallocs:2 Frees:2} </span><br><span class="line">{Size:14336 Mallocs:1 Frees:0} </span><br><span class="line">{Size:16384 Mallocs:0 Frees:0} </span><br><span class="line">{Size:18432 Mallocs:2 Frees:2} </span><br><span class="line">{Size:19072 Mallocs:0 Frees:0}</span><br><span class="line">] //具体内存分配情况 </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">yexm</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://yexm.github.io/2020/12/30/8ee6e562cee56457039b54c622d6858f/">https://yexm.github.io/2020/12/30/8ee6e562cee56457039b54c622d6858f/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yexm.github.io" target="_blank">yexm</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/2020/12/30/8ee6e562cee56457039b54c622d6858f/go-code.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/12/30/6d802f62f4c4d693e9a9c05179178991/"><img class="prev-cover" src="/2020/12/30/6d802f62f4c4d693e9a9c05179178991/go-schedule0.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">golang trace</div></div></a></div><div class="next-post pull-right"><a href="/2020/12/28/8cb3dc7e45f963bebee0323515a4dd31/"><img class="next-cover" src="/2020/12/28/8cb3dc7e45f963bebee0323515a4dd31/go-code.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">for循环内defer</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">yexm</div><div class="author-info__description">今日事，今日毕竟</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">93</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">26</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/yexm" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:yexingmin06221@126.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">十步一代码，千里不bug</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/16/example/" title="example"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="example"/></a><div class="content"><a class="title" href="/2021/05/16/example/" title="example">example</a><time datetime="2021-05-16T10:38:41.000Z" title="发表于 2021-05-16 18:38:41">2021-05-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/11/798f7e7017cd550dfc61b041d5250ac9/" title="使用go/analysis自己实现linter"><img src="/2021/05/11/798f7e7017cd550dfc61b041d5250ac9/go-schedule0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用go/analysis自己实现linter"/></a><div class="content"><a class="title" href="/2021/05/11/798f7e7017cd550dfc61b041d5250ac9/" title="使用go/analysis自己实现linter">使用go/analysis自己实现linter</a><time datetime="2021-05-11T00:00:18.000Z" title="发表于 2021-05-11 08:00:18">2021-05-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/10/eec19ee821d35d2e8d8cbfa6c0831b9a/" title="go底层利器之ast以及它的妙用"><img src="/2021/05/10/eec19ee821d35d2e8d8cbfa6c0831b9a/go0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="go底层利器之ast以及它的妙用"/></a><div class="content"><a class="title" href="/2021/05/10/eec19ee821d35d2e8d8cbfa6c0831b9a/" title="go底层利器之ast以及它的妙用">go底层利器之ast以及它的妙用</a><time datetime="2021-05-10T13:55:18.000Z" title="发表于 2021-05-10 21:55:18">2021-05-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/09/d1bed1805f4556560852111651ab9507/" title="公司为什么需要建立一套统一的开发框架"><img src="/2021/05/09/d1bed1805f4556560852111651ab9507/go0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="公司为什么需要建立一套统一的开发框架"/></a><div class="content"><a class="title" href="/2021/05/09/d1bed1805f4556560852111651ab9507/" title="公司为什么需要建立一套统一的开发框架">公司为什么需要建立一套统一的开发框架</a><time datetime="2021-05-09T15:05:26.000Z" title="发表于 2021-05-09 23:05:26">2021-05-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/05/75fc4301d28ff2d0570143783f522ced/" title="go module"><img src="/2021/05/05/75fc4301d28ff2d0570143783f522ced/go0.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="go module"/></a><div class="content"><a class="title" href="/2021/05/05/75fc4301d28ff2d0570143783f522ced/" title="go module">go module</a><time datetime="2021-05-05T01:36:25.000Z" title="发表于 2021-05-05 09:36:25">2021-05-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021  <i id="heartbeat" class="fa fas fa-heartbeat"></i> yexm</div><div class="footer_custom_text">当你的才华还撑不起野心时，那你就应该静下心来学习</div></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><div class="aplayer no-destroy" data-id="944518800" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="true" muted></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config-diff',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener toc scroll 
  window.removeEventListener('scroll', window.tocScrollFn)

  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>